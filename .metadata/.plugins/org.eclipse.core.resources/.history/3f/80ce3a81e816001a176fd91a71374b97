<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1" import="com.cs336.pkg.*"%>
<!--Import some libraries that have classes that we need -->
<%@ page import="java.io.*,java.util.*,java.sql.*,java.text.*"%>
<%@ page import="javax.servlet.http.*,javax.servlet.*"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta charset="ISO-8859-1">
<title>EarningPerItem</title>
</head>
<body bgcolor=#a6dced>
<%
ApplicationDB db = new ApplicationDB();	
Connection con = db.getConnection();
Statement stmt= con.createStatement();
ResultSet rs=stmt.executeQuery("SELECT * FROM Phones ORDER BY Price DESC");
while(rs.next())
{
	String savedTime = rs.getString("bidExpiration");
	SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
	sdf.setTimeZone(TimeZone.getTimeZone("America/New_York"));
	java.util.Date now=new java.util.Date();
	TimeZone.setDefault(TimeZone.getTimeZone("America/New_York"));
	java.util.Date newdate= new java.util.Date(sdf.parse(savedTime).getTime());
	if(newdate.compareTo(now) == -1 && rs.getDouble("hiddenPrice") <= rs.getDouble("Price"))
	{
		out.println(rs.getString("Brand_Name")+" Phone bought for: "+rs.getDouble("Price"));
		out.println("Higest Bidder: " + rs.getString("currentBidder"));
		out.println("Sold by:" + rs.getString("sellerID"));
	}
	%><br /><%
}
	con.close();
%>
<a href="Sales.jsp">Sale Report</a>
</body>
</html>